<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sign Up</title>
	<!--Initialize Firebase-->
	<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-app.js"></script>
	<!--Initialize Firebase Auth-->
	<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-auth.js"></script>
	<!--Initialize Firestore-->
	<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-firestore.js"></script>
	<!--Firebase config object-->
	<script src="init-firebase-auth.js"></script>
	<script type="text/javascript">

		function userSignUp() {
			// Retrieve email and password
			var email = document.getElementById('email').value;
			var password = document.getElementById('password').value;

			// Validate email and password
			if (email.length < 4) {
				alert('Please enter a valid email address');
				return;
			}
			if (password.length < 8) {
				alert('Password must contain at least 8 characters');
				return;
			}
			/*
			This code will eventually ensure that the user enters a password that
			has at least 8 characters, 1 uppercase letter, 1 lowercase letter,
			1 number, and 1 special character (excluding < and >)
			*/
			/*
			var lowCase = false, upCase = false, numChar = false, specChar = false;
			for (var i = 0; i < password.length; i++) {
				const currentChar = password.charAt(i);
				if (currentChar == currentChar.toLowerCase() )
					lowCase = true;
				else if (currentChar == currentChar.toUpperCase() )
					upCase = true;
				else if (currentChar == 
			}
			if (!lowCase) {
				alert('Please include a lowercase character in password');
				return;
			} else if (!upCase) {
				alert('Please include a lowercase character in password');
				return;
			} else if (!numChar) {
				alert('Please include a lowercase character in password');
				return;
			} else if (!specChar) {
				alert('Please include a lowercase character in password');
				return;
			}*/

			// Creates Firebase user instance 
			var auth = firebase.auth();

			// Sends email and password to Firebase Auth and creates new account
			auth.createUserWithEmailAndPassword(email, password).catch(function (error) {
				alert('Could not create new account');
				return;
			});
			
			// Event listener that redirects to content page after detection of login
			// Note: User is saved in browser's local storage so no need to manually transfer
			auth.onAuthStateChanged(function (user) {
				if (user) {
					window.location = "content.html";
				}
			});
		}

	</script>
</head>

<body>
	<h2>User Sign-Up</h2>
	<label for="email">Email: </label>
	<input type="text" id="email" name="email">
	</br></br>
	<label for="password">Password: </label>
	<input type="password" id="password" name="password">
	</br></br>
	<!--
	<label for="username">Name: </label>
	<input type="text" id="username" name="username">
	</br></br>-->
	<button id="sign-up" name="signup" onclick="userSignUp()">Sign Up</button>
	</br></br>
	<a href="login.html">Back to sign in</a>
</body>

</html>